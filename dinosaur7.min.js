let _d7Mode="dev";!function(t){let e=function(t){throw"dev"===_d7Mode&&alert(t),Error("[Dinosaur7]error! "+t)};class r{constructor(t,e){this.fullname=t,this.params=e,this.conf={pagebase:"",apibase:""},this.childseq=0,this.children={},this._WORK={showed:!1},this._CACHE={funcRender:{}},this.assignBlock=function(e){e.setAttribute("_d7name",t),e.querySelectorAll("[_d7=DUMMY]").forEach(function(t){t.remove()}),this._WORK.ROOT=e,this._WORK.TPLT=document.createElement(e.tagName),this._WORK.TPLT.innerHTML=e.innerHTML}}}let n={start:"{%",close:"%}"},s={"<":"&lt;",">":"&gt;","&":"&amp;",'"':"&quot;","'":"&#39;"," ":"&nbsp;","ã€€":"&emsp;"},i={CAPTION:"table",THEAD:"table",TFOOT:"table",TBODY:"table",TR:"table",COLGROUP:"table tr","COL: ":"table tr",TH:"table tr",TD:"table tr",LI:"ul",DT:"dl",DD:"dl",OPTION:"select",OPTGROUP:"select",AREA:"map",LEGEND:"fieldset"},o=function(t){var e=document.createElement("div"),r=i[t.toUpperCase()];if(!r)return e;var n=r.split(" ");for(var s in n){var o=document.createElement(n[s]);e.append(o),e=o}return e},l=function(t,e,r,n){if(!t||!t)return null;for(var s=0,i=-1,o=e;o<t.length;o++){var l=t.charAt(o);if(l===r&&(0===s&&(i=o),s++),l===n){if(1===s)return[i,o];s--}}return null},a=function(t){if(t||(t="_d7Root"),this._CACHE.funcRender[t])return this._CACHE.funcRender[t];var r=this._WORK.TPLT;if("_d7Root"!==t){var n=this._WORK.TPLT.querySelectorAll(t);if(n.length<1){e("not found target block with selector ["+t+"]");return}if(n.length>2){e("only one block is allowed, but there is "+n.length+" with selector["+t+"]");return}r=n[0]}var s=c(r),i=f(s);return this._CACHE.funcRender[t]=i,i},c=function(t){var e,r=t.outerHTML,s=RegExp("(<!\\-\\-\\s*)?("+n.start+")","gm"),i=RegExp("("+n.close+")(\\s*\\-\\->)?","gm");r=(r=r.replace(s,function(t,e,r){return"<!-- "+r})).replace(i,function(t,e,r){return e+" -->"});var a=o(t.tagName);a.innerHTML=r;var c={},f=0;let d="_d7l0Gic";for(e in a.querySelectorAll("[_d7]").forEach(function(t){var r=t.getAttribute("_d7").trim();t.removeAttribute("_d7");var s=u(r);s.start&&(c[e=d+ ++f+"E"]=n.start+" "+s.start+" "+n.close,t.before(e)),s.close&&(c[e=d+ ++f+"E"]=n.start+" "+s.close+" "+n.close,t.after(e))}),a.querySelectorAll("[_d7v]").forEach(function(t){var e=t.getAttribute("_d7v");e.endsWith(".")&&(e.startsWith("_m.")||e.startsWith("=m."))&&h(t,e)}),a.querySelectorAll("[_d7v]").forEach(function(t){var e=t.getAttribute("_d7v").split(",")[0];if(t.setAttribute("_d7vi",`${n.start}_c.push(${e.replaceAll("=m.","_m.")})${n.close}${n.start}=_c.length-1${n.close}`),e.startsWith("=m.")){var r=(t.getAttribute("_d7m")||"").split(",");if(!r[0]){for(var e=e.substring(3),s=0,i=0;pos=l(e,s,"[","]");i++)e=e.substring(0,pos[0]+1)+e.substring(pos[1]),s=pos[0]+2;r[0]=e,t.setAttribute("_d7m",r.join(","))}}}),a.querySelectorAll("[_d7m]").forEach(function(t){var e=t.getAttribute("_d7m");if(!(0>e.indexOf(","))){var r=e.split(",");e=r[0];for(var n=0,s=0;pos=l(e,n,"[","]");s++){if(!r.includes(s.toString())){n=pos[1]+1;continue}e=e.substring(0,pos[0]+1)+"+"+e.substring(pos[1]),n=pos[0]+3}var i=r[1]||"";t.setAttribute("_d7m",isNaN(i)?e+","+i:e)}}),r=a.innerHTML,c)r=r.replace(e,c[e]);return r},u=function(t){var r=l(t=t.trim(),0,"(",")");r||e("analyzeD7Logic: "+t);var n=t.substring(0,r[0]).trim(),s=t.substring(0,r[1]+1).trim(),i=t.substring(r[1]+1).trim();return"if"===n?i.match(/^continue|break/)?{start:t}:{start:i.startsWith("{")?t:`${s}{${i}`,close:"}"}:"for"===n?{start:i.startsWith("{")?t:`${s}{${i}`,close:"}"}:void e("analyzeD7Logic: "+t)},h=function(t,e){t.removeAttribute("_d7v"),t.children.forEach(function(t){if(!t.hasAttribute("_d7v")){h(t,e);return}var r=t.getAttribute("_d7v");if(r.startsWith("_m.")||r.startsWith("=m.")){if(r.endsWith("."))return;h(t,e);return}if(r.endsWith(".")){h(t,e+r);return}t.setAttribute("_d7v",e+r),h(t,e)})},f=function(t){r="(<!\\-\\-\\s*)?",r+="("+n.start+")",r+="([\\s\\S]*?)",r+="("+n.close+")",r+="(\\s*\\-\\->)?";var r,s=(t=t.replace(/[\r\n]/g,"").replace(/'/g,"\\'")).replace(RegExp(r,"gm"),function(t,e,r,n,s,i){return(n=n.replace(/\\'/gm,"'").trim()).startsWith("=<")?"'.replaceAll('_d7.', _d7name + '.') + this.util.encodeHtml("+(n=n.substring(2))+") + '":n.startsWith("=")?"_c.length-1"===(n=n.substring(1))?"' + ("+n+") + '":"'.replaceAll('_d7.', _d7name + '.') + ("+n+") + '":"'.replaceAll('_d7.', _d7name + '.');"+n+"; out+='"});s="var out=''; out+='"+s+"'.replaceAll('_d7.', _d7name + '.'); return out;";try{return Function("_m","_c","_d7name",s)}catch(i){e(i.message+"\n"+s)}},d={},p=function(t,e){t.childseq++;var n=t.fullname+".children.c"+t.childseq,s=new r(n,e);for(var i in _d7root.conf)s.conf[i]=_d7root.conf[i];return t.children["c"+t.childseq]=s,s},v=function(t){for(var e=_d7root,r=t.split("."),n=3;n<r.length;n+=2)e=e.children[r[n-1]];delete e.children[r[r.length-1]],document.querySelectorAll("[_d7nameref]").forEach(function(e){e.getAttribute("_d7nameref").startsWith(t)&&e.remove()})},m=function(t,r){var n=t.getAttribute("_d7name");n&&v(n);var s=t.getAttribute("compsrc");r||(r=L(s));var i=p(this,r);if(d[s])return T(t,d[s],i);var o=!!t.hasAttribute("compseq"),l=new XMLHttpRequest;if(l.open("GET",s,!o),o){if(l.send(null),200===l.status){var a=d[s]=y(l.responseText);return T(t,a,i)}return e(`http: ${s} status[${l.status}]`),null}return l.onload=function(){if(200==l.status){var r=d[s]=y(l.responseText);T(t,r,i)}else e(`http: ${s} status[${l.status}]`)},l.onerror=function(){e(`http: ${s} status[${l.status}]`)},l.send(null),null},g=[],b=[],y=function(t){var e=document.createElement("div");e.innerHTML=t;var r="",n=[],s="",i=[];e.querySelectorAll("style").forEach(function(t){r+=t.innerHTML+"\n\n\n",t.remove()}),e.querySelectorAll('[rel="stylesheet"]').forEach(function(t){var e=t.getAttribute("href");n.push(e),t.remove()}),e.querySelectorAll("script").forEach(function(t){var e=t.getAttribute("src");e?i.push(e):s+=t.innerHTML+"\n;\n;\n;",t.remove()});var o=e.querySelector("mainblock");if(o||(o=e.querySelector("[mainblock]")),o)t=o.innerHTML;else{var l=e.querySelector("head");l&&l.remove(),t=e.innerHTML}return{html:t,css:r,cssTags:n,script:s,scriptTags:i}},T=function(t,e,r){t.innerHTML=e.html;var n=document.querySelector("head");for(var s in e.cssTags)if(!g.includes(e.cssTags[s])){g.push(e.cssTags[s]);var i=document.createElement("link");i.type="text/css",i.setAttribute("rel","stylesheet"),i.setAttribute("href",e.cssTags[s]),n.appendChild(i)}if(e.css){var i=document.createElement("style");i.type="text/css",i.innerHTML=e.css,i.setAttribute("_d7nameref",r.fullname),n.appendChild(i)}for(var s in e.scriptTags)if(!b.includes(e.scriptTags[s])){b.push(e.scriptTags[s]);var i=document.createElement("script");i.type="text/javascript",i.setAttribute("src",e.scriptTags[s]),n.appendChild(i)}return r.assignBlock(t),Function("_d7",e.script)(r),"function"==typeof r._funcOnload||r._WORK.showed||r.show(),r},A=function(t,r,n){for(var s="R",i=r.length-1,o=0;o<=i;o++){var l=r[o];if(!l.startsWith("[")){if(t instanceof Object||e("not a MAP. "+s),o==i)return t;t[l]||(r[o+1].startsWith("[")?t[l]=[]:t[l]={}),t=t[l],s+="."+l;continue}t instanceof Array||e("not a LIST. "+s);var a=l.substring(1,l.length-1);if(""===a){if(o==i)return r[o]=t.length,t.push(null),t;if(t.length<1){s=s.substring(2),e(`forgot specify new array flag?
   _d7m="${s}[+].key" 
or _d7m="${s}[].key,0" 
or _d7v="=m.${s}[var].key,0" _d7m=",0"`);return}s+="["+((t=t[t.length-1]).length-1)+"]";continue}if("+"===a){if(o==i)return r[o]=t.length,t.push(null),t;r[o+1].startsWith("[")?t.push([]):t.push({}),s+="["+((t=t[t.length-1]).length-1)+"]";continue}if(a.startsWith("<")){var c=parseInt(a.substring(1)||"0");if(o==i){for(var u=t.length-1;u<c-1;u++)t.push(null);return t.splice(c,0,null),r[o]=c,t}if(s+="["+c+"]",r[o+1].startsWith("[")){for(var u=t.length-1;u<c-1;u++)t.push([]);t.splice(c,0,[])}else{for(var u=t.length-1;u<c-1;u++)t.push({});t.splice(c,0,{})}t=t[c];continue}var c=parseInt(a);if(c<0&&e("array must be one of these [], [+], [n], [<n]. "+s),o==i){for(var u=t.length-1;u<c;u++)t.push(null);r[o]=c;break}if(s+="["+c+"]",r[o+1].startsWith("["))for(var u=t.length-1;u<c;u++)t.push([]);else for(var u=t.length-1;u<c;u++)t.push({});t=t[c]}return t},$=function(t,r,n){var s=t.getAttribute("_d7m");if(s){(s=s.replaceAll(" ","")).startsWith("[")&&e("_d7m can not starts with array "+t.outerHTML);var i=s.split(","),o=i[0].trim().replaceAll("[",".[").replaceAll("..",".").split(".");A(r,o,n)[o[o.length-1]]=t.val(i[1]||"")}for(var l=0;l<t.children.length;l++)$(t.children[l],r,n);return r},O=r.prototype;O.onload=function(t){var e=this;this._WORK._funcOnload=function(){t.call(e)},this._WORK.ROOT&&this._WORK._funcOnload(e)},O.s=function(t,e){if(!t)return this._WORK.ROOT;if(void 0===e)return this._WORK.ROOT.querySelector(t);var r=this._WORK.ROOT.querySelectorAll(t);return r.length<e?null:r[e-1]},O.S=function(t){return t?this._WORK.ROOT.querySelectorAll(t):[this._WORK.ROOT]},O.m=function(t){var r=this.s(t);r||e("target block not exists. "+t);var n={};return $(r,n,{}),n};let _=function(t,r){this._WORK.TPLT||e("not onload yet.");var n=this._WORK.TPLT.s(r);n||e("target block not exists in template. "+r);var s=[],i=o(n.tagName);return i.innerHTML=a.call(this,r)(t,s,this.fullname),i.querySelectorAll("[_d7v]").forEach(function(t){var e=t.getAttribute("_d7vi"),r=t.getAttribute("_d7v").split(",");t.val(r[1]||"",s[e]),t.removeAttribute("_d7v"),t.removeAttribute("_d7vi")}),i.querySelectorAll("[compsrc]").forEach(function(t){t.hasAttribute("solidblock")||(t.style.display="none")}),i.firstChild};O.render=function(t,r){var n=this,s=_.call(n,t||{},r),i=n._WORK.ROOT.s(r);i||e("target block not exists."),i.innerHTML=s.innerHTML,i.querySelectorAll("[compsrc]").forEach(function(t){t.hasAttribute("solidblock")||m.call(n,t)}),n.show(!0)},O.renderTo=function(t,r,n,s,i){var o=this,l=_.call(o,t||{},r),a=o.s(s);if(a||e("target block not exists."),n||i){var c=l.children;if(n&&(c=l.querySelectorAll(n)),i)for(var u=a.querySelector(i),h=0;h<c.length;h++)u.parentNode.insertBefore(c[h],u);else for(var h=0;h<c.length;h++)a.insertBefore(c[h],null)}else a.innerHTML=l.innerHTML;a.querySelectorAll("[compsrc]").forEach(function(t){t.hasAttribute("solidblock")||m.call(o,t)}),o.show(!0)},O.remove=function(t,e){if(void 0===e){this.s(t).remove();return}for(var r=this.s(t).children,n=0;n<r.length;n++)if(n==e){r[e].remove();break}},O.show=function(t){!_d7root._WORK.showed&&(document.body?(document.body.style.display="block",document.body.style.visibility="visible"):document.querySelector("header +").style.display="block",_d7root._WORK.showed=!0),!1===t?this._WORK.ROOT.style.display="none":this._WORK.ROOT.style.display="block",this._WORK.showed=!0},O.loadpage=function(t,e){var r=_d7root._WORK.ROOT;r.setAttribute("compsrc",_d7root.conf.pagebase+t),m.call(_d7root,r,e)},O.api=function(t,r,n,s,i){E();var o=this;n||(n={}),n.method||(n.method="GET"),n.responseType||(n.responseType="JSON"),n.header||(n.header={}),n.method=n.method.toUpperCase(),n.responseType=n.responseType.toUpperCase(),"GET"==n.method&&(t=this.util.stringifyUrl(t,r)),t=o.conf.apibase+t;var l=new XMLHttpRequest;for(var a in l.onload=function(){var r;try{r="JSON"==n.responseType?JSON.parse(l.responseText):l.responseText}catch(a){"JSON"==n.responseType?(r={_error:"JsonParse"}).response=l.responseText:r=l.responseText}200==l.status?s&&s.call(o,r):(i&&i.call(o,r,l.status),e(`http:${n.method} ${t} status[${l.status}]`)),E(!1)},l.onerror=function(){i&&i.call(o,l.responseText,l.status),e(`http:${n.method} ${t} status[failed]`),E(!1)},l.open(n.method,t),n.header)l.setRequestHeader(a,n.header[a]);l.setRequestHeader("Content-Type","application/json; charset=utf-8"),l.send("GET"===n.method?null:JSON.stringify(r))};let L=function(t){var e={};t=t.startsWith("http:")?t:"http://tmp.com"+t;let r=new URL(t);return new URLSearchParams(r.search).forEach(function(t,r){e[r]=t}),e};O.util={},O.util.encodeHtml=function(t){return t=(t=t||"").replace(/./g,function(t){return s[t]||t})},O.util.stringifyUrl=function(t,e){return e&&Object.keys(e).length?t+"?"+Object.keys(e).map(function(t){return t+"="+encodeURIComponent(e[t])}).join("&"):t},O.util.stringifyJSON=function(t){return JSON.stringify(t)},O.util.parseJSON=function(t){return JSON.parse(t)},O.util.format=function(t,r,n){if(","===r||"comma"===r)return"string"==typeof t&&(t=Number(t)),t.toLocaleString()+(n||"");if(t=t.replaceAll(" ",""),"date"===r){if(t.length>7)return t.substring(0,4)+n+t.substring(4,6)+n+t.substring(6,8);e("wrong date value. "+t)}if("datetime"===r){if(t.length>13)return t.substring(0,4)+n+t.substring(4,6)+n+t.substring(6,8)+" "+t.substring(8,10)+":"+t.substring(10,12)+":"+t.substring(12,14);e("wrong datetime value. "+t)}if("time"===r){if(t.length>13)return t.substring(8,10)+":"+t.substring(10,12)+":"+t.substring(12,14);if(t.length>5)return t.substring(0,2)+":"+t.substring(2,4)+":"+t.substring(4,6);e("wrong time value. "+t)}e("wrong format."+r)},O.util.emitEvent=function(t,r,n){var s=document.querySelector(t);s||e("target not found in emitEvent. "+t),r.startsWith("on")&&(r=r.substring(2)),s.dispatchEvent(new Event(r,n))},O.util.persistVal=function(t,e){try{if(localStorage.setItem("dummytest","1"),"1"===localStorage.getItem("dummytest")){if(void 0===e)return localStorage.getItem(t);localStorage.setItem(t,e),null!=e?localStorage.setItem(t,e):localStorage.removeItem(t);return}}catch(r){}if(void 0===e){var n={};return(document.cookie||"").split("; ").forEach(function(t){var e=t.split("=");n[e[0]]=decodeURIComponent(e[1])}),n[t]}var s=new Date;null!=e?s.setTime(s.getTime()+31536e6):s.setTime(s.getTime()-1e3),document.cookie=`${t}=${encodeURIComponent(e)}; expires=${s.toGMTString()}`};class R{constructor(t,e){this.cssPrefix="_d7_"+t;var r=document.createElement("div");r.classList.add(this.cssPrefix+"_form"),r.innerHTML=this.html;var n=document.createElement("div");n.classList.add(this.cssPrefix+"_overlay"),n.appendChild(r),this.form=r,this.container=n;var s=this;e&&(r.onclick=function(t){t.stopPropagation()},n.onclick=function(){s.close()})}}let W=R.prototype;W.open=function(){var t=this;document.body.appendChild(this.container),setTimeout(function(e){t.form.classList.add(e+"_form_show"),t.container.classList.add(e+"_overlay_show")},120,t.cssPrefix)},W.close=function(){this.form.classList.remove(this.cssPrefix+"_form_show"),this.form.classList.add(this.cssPrefix+"_form_closing"),this.form.classList.remove(this.cssPrefix+"_overlay_show"),this.container.classList.add(this.cssPrefix+"_overlay_closing");var t=this.form.getAttribute("_d7name");setTimeout(function(t,e){document.body.removeChild(t),e&&v(e)},300,this.container,t)},O.popup=function(t,r,n){let s=document.querySelector(t);s||e(`can not find popup block. selector[${t}]`);var i=new R("popup",n);i.form.innerHTML=s.innerHTML;var o=p(this,r);return o.assignBlock(i.form),o.render(r),o.close=function(){i.close()},i.open(),o},O.loadmodal=function(t,e,r){var n=new R("modal",r);n.form.setAttribute("compsrc",t),n.form.setAttribute("compseq",999);var s=m.call(this,n.form,e);return s.close=function(){n.close()},n.open(),s};let S=null,E=function(t){if(!1===t){S&&(S.close(),S=null);return}S||((S=new R("processing",!1)).form.innerHTML="<span class='_d7_processing'>processing</span>",S.open())};O.processing=E,Element.prototype.s=function(t,e){if(!t)return this;if(void 0===e)return this.querySelector(t);var r=this.querySelectorAll(t);return r.length<e?null:r[e-1]},Element.prototype.S=function(t){return t?this.querySelectorAll(t):[this]},Element.prototype.val=function(t,e){if(void 0===e)return t?"text"===t||"innerHTML"===t?this.innerHTML:this.getAttribute(t):void 0!==this.value?this.value:this.innerHTML;return t?"text"==t||"innerHTML"===t?(this.innerHTML=e,this):(this.setAttribute(t,e),this):void 0!==this.value?(this.value=e,this):(this.innerHTML=e,this)},Element.prototype.css=function(t,r){if(void 0===t){var n={};return(this.style.cssText||"").split(";").forEach(function(t){var e=t.split(":");e.length<2||(n[e[0].trim()]=e[1].trim())}),n}if(void 0===r){if("string"==typeof t)return this.style[t];for(var s in t)this.style[s]=t[s];return this}return("string"!=typeof t&&e("[propOrMap] must be a string when set or remove."),null===r)?(this.style[t]=null,this):(this.style[t]=r,this)},Element.prototype.clazz=function(t,r){if(void 0===t){for(var n=[],s=0;s<this.classList.length;s++)n.push(this.classList[s]);return n}if(void 0===r){if("string"==typeof t)return this.classList.contains(t);for(var s=0;s<t.length;s++)this.classList.add(t[s]);return this}return("string"!=typeof t&&e("[classOrList] must be a string when add or remove."),null===r)?(this.classList.remove(t),this):(this.classList.add(t),this)},Element.prototype.attr=function(t,r){return(t||e("[prop] can not be empty."),void 0===r)?this.hasAttribute(t)?this.getAttribute(t)||"":null:null===r?(this.removeAttribute(t),this):(this.setAttribute(t,r),this)};let q=new r("_d7",L(window.location.href));t._d7=t._d7root=q;let k=function(){var t=document.querySelector("mainblock");t||(t=document.querySelector("[mainblock]")),t||e("mainblock not defined."),t.style.display="none";var r=[],n=[];document.querySelectorAll("[compsrc]").forEach(function(t){if(!(t.hasAttribute("solidblock")||t.closest("mainblock"))&&!t.closest("[mainblock]")){if(t.style.display="none",t.hasAttribute("compseq")){r.push(t);return}n.push(t)}}),document.querySelectorAll('[rel="stylesheet"]').forEach(function(t){g.push(t.getAttribute("href"))}),document.querySelectorAll("script").forEach(function(t){var e=t.getAttribute("src");e&&b.push(e)});for(var s=0;s<n.length;s++)m.call(_d7root,n[s]);r.sort(function(t,e){var r=parseInt(t.getAttribute("compseq")),n=parseInt(e.getAttribute("compseq"));return r>n?1:r<n?-1:0});for(var s=0;s<r.length;s++)m.call(_d7root,r[s]);if(_d7root.assignBlock(t),_d7root._WORK.ROOT.hasAttribute("solidblock")||q.conf.autoloadoff){_d7root._WORK._funcOnload,_d7root._WORK._funcOnload.call(_d7root);return}_d7root.conf.pagebase||e('should specify [solidblock] in <mainblock> or define page\'s html root in SPA mode such as _d7.conf.pagebase = "/html/page". '),_d7root.loadpage(window.location.pathname,L(window.location.href))};"loading"===document.readyState?document.addEventListener("DOMContentLoaded",function(){k()}):k()}(this);
